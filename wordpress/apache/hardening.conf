# ServerTokens Prod
# ServerSignature Off
# TraceEnable Off

# <Directory "/var/www/html">
#   Options -Indexes
#   AllowOverride All
#   <FilesMatch "(^\.|wp-config\.php|readme\.html|license\.txt)">
#     Require all denied
#   </FilesMatch>
# </Directory>

# <LocationMatch "^/xmlrpc\.php$">
#   Require all denied
# </LocationMatch>

# <Directory "/var/www/html/wp-content/uploads">
#   <FilesMatch "\.php$">
#     Require all denied
#   </FilesMatch>
# </Directory>
# /var/www/E2C/wordpress/apache/hardening.conf
ServerTokens Prod
ServerSignature Off
TraceEnable Off

<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set X-XSS-Protection "1; mode=block"
</IfModule>

<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/avif "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/png  "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif  "access plus 1 year"
  ExpiresByType text/css   "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
</IfModule>

<Directory "/var/www/html">
  Options -Indexes
  AllowOverride All
  <FilesMatch "(^\\.|wp-config\\.php|readme\\.html|license\\.txt)">
    Require all denied
  </FilesMatch>
  Require all granted
</Directory>

# Bloquer xmlrpc (attaques/bruit inutiles)
<LocationMatch "^/xmlrpc\\.php$">
  Require all denied
</LocationMatch>

# Interdire PHP dans uploads
<Directory "/var/www/html/wp-content/uploads">
  <FilesMatch "\\.php$">
    Require all denied
  </FilesMatch>
</Directory>
